# 4ë‹¨ê³„ ì™„ë£Œ ìš”ì•½ - ëŒ€ì¶œ ê³„ì‚° ì•Œê³ ë¦¬ì¦˜

## âœ… êµ¬í˜„ ì™„ë£Œ í•­ëª©

### 1. í•µì‹¬ ê³„ì‚° ì—”ì§„
- **íŒŒì¼**: `src/lib/strategies/repayment-strategy.ts`
- **ë‚´ìš©**:
  - `RepaymentStrategy` ì¸í„°í˜ì´ìŠ¤ (Strategy Pattern)
  - `EqualPrincipalInterestStrategy` (ì›ë¦¬ê¸ˆê· ë“± ìƒí™˜)
  - `EqualPrincipalStrategy` (ì›ê¸ˆê· ë“± ìƒí™˜)
  - `calculateEarlyRepayFee()` (ì¤‘ë„ìƒí™˜ ìˆ˜ìˆ˜ë£Œ ê³„ì‚°)

### 2. ê¸ˆìœµ ìƒìˆ˜ ê´€ë¦¬
- **íŒŒì¼**: `src/lib/config/finance-config.ts`
- **ë‚´ìš©**:
  - ì¸ì§€ì„¸ ê³„ì‚° ë¡œì§
  - ê¸ˆë¦¬/ê¸ˆì•¡/ê¸°ê°„ ì œí•œ ìƒìˆ˜
  - í¬ë§·íŒ… í—¬í¼ í•¨ìˆ˜
  - ìœ íš¨ì„± ê²€ì¦ í•¨ìˆ˜

### 3. ì‹œë®¬ë ˆì´ì…˜ ì„œë¹„ìŠ¤
- **íŒŒì¼**: `src/lib/services/simulation-service.ts`
- **ë‚´ìš©**:
  - `simulateRefinancing()` - ë‹¨ì¼ ìƒí’ˆ ì‹œë®¬ë ˆì´ì…˜
  - `findBestRefinancingOption()` - ìµœì  ìƒí’ˆ ì°¾ê¸°
  - ì†ìµë¶„ê¸°ì (BEP) ê³„ì‚°
  - ì¶”ì²œ ì•¡ì…˜ ê²°ì • ë¡œì§

### 4. ì…ë ¥ê°’ ê²€ì¦
- **íŒŒì¼**: `src/lib/utils/validation.ts`
- **ë‚´ìš©**:
  - `ValidationError` í´ë˜ìŠ¤
  - `validateCurrentDebt()` - í˜„ì¬ ëŒ€ì¶œ ê²€ì¦
  - `validateNewLoanProduct()` - ì‹ ê·œ ìƒí’ˆ ê²€ì¦
  - `validateSimulationInputs()` - ì „ì²´ ì…ë ¥ê°’ ê²€ì¦
  - 10ê°€ì§€ ì—£ì§€ ì¼€ì´ìŠ¤ ì²˜ë¦¬

### 5. API ì—”ë“œí¬ì¸íŠ¸
- **íŒŒì¼**: `src/app/api/simulate/route.ts`
- **ì—”ë“œí¬ì¸íŠ¸**: `POST /api/simulate`
- **ê¸°ëŠ¥**:
  - ëŒ€í™˜ëŒ€ì¶œ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
  - ì…ë ¥ê°’ ê²€ì¦
  - ì—ëŸ¬ í•¸ë“¤ë§
  - ì‘ë‹µ íƒ€ì… ì •ì˜

### 6. í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
- **íŒŒì¼**: `src/lib/utils/test-examples.ts`
- **ì‹œë‚˜ë¦¬ì˜¤**:
  1. ì¼ë°˜ì ì¸ ëŒ€í™˜ëŒ€ì¶œ (ì¦‰ì‹œ ì´ë“)
  2. ì†í•´ ë³´ëŠ” ê²½ìš° (ê¸ˆë¦¬ ìƒìŠ¹)
  3. ìˆ˜ìˆ˜ë£Œ ë©´ì œ ëŒ€ê¸° ê¶Œì¥
  4. ì—¬ëŸ¬ ìƒí’ˆ ì¤‘ ìµœì  ì„ íƒ
  5. ì—£ì§€ ì¼€ì´ìŠ¤ - ë¬´ì´ì ëŒ€ì¶œ
  6. ì›ê¸ˆê· ë“± vs ì›ë¦¬ê¸ˆê· ë“± ë¹„êµ

### 7. ë¬¸ì„œí™”
- **íŒŒì¼**: `docs/edge-cases-analysis.md`
- **ë‚´ìš©**:
  - 10ê°€ì§€ ì£¼ìš” ë¬¸ì œì  ë¶„ì„
  - High/Medium/Low Priority ë¶„ë¥˜
  - í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸
  - ê°œì„  ìš°ì„ ìˆœìœ„

---

## ğŸ“Š ê¸ˆìœµ ìˆ˜ì‹ ë° ê·¼ê±°

### ì›ë¦¬ê¸ˆê· ë“± ìƒí™˜
```
ì›” ìƒí™˜ì•¡ = P Ã— [r Ã— (1+r)^n] / [(1+r)^n - 1]
```
- **ê·¼ê±°**: ë“±ë¹„ê¸‰ìˆ˜ ê³µì‹ (í˜„ì¬ ê°€ì¹˜ì˜ í•© = ë¯¸ë˜ ê°€ì¹˜ì˜ í•©)
- **íŠ¹ì§•**: ë§¤ì›” ë™ì¼ ê¸ˆì•¡, ì´ˆë°˜ ì´ì ë¹„ì¤‘ ë†’ìŒ

### ì›ê¸ˆê· ë“± ìƒí™˜
```
ì›” ì›ê¸ˆ = P / n
ë§¤ì›” ì´ì = ì”ì—¬ì›ê¸ˆ Ã— ì›” ì´ììœ¨
```
- **ê·¼ê±°**: ì›ê¸ˆ ê· ë“± ë¶„í• , ì´ìëŠ” ì”ì•¡ ê¸°ì¤€
- **íŠ¹ì§•**: ì´ ì´ì ë¶€ë‹´ ì ìŒ, ì´ˆê¸° ìƒí™˜ì•¡ ë†’ìŒ

### ì¤‘ë„ìƒí™˜ ìˆ˜ìˆ˜ë£Œ
```
ê¸°ë³¸ ìˆ˜ìˆ˜ë£Œ = ì”ì—¬ì›ê¸ˆ Ã— ìˆ˜ìˆ˜ë£Œìœ¨(%)
ì¡°ì • ìˆ˜ìˆ˜ë£Œ = ê¸°ë³¸ ìˆ˜ìˆ˜ë£Œ Ã— (ì”ì—¬ê°œì›” / ì „ì²´ê°œì›”)
```
- **ê·¼ê±°**: ì€í–‰ì˜ ì˜ˆìƒ ì´ì ìˆ˜ìµ ì†ì‹¤ ë³´ì „
- **íŠ¹ì§•**: ì‹œê°„ ê²½ê³¼ì— ë”°ë¼ ë¹„ë¡€ ê°ì†Œ

### ì†ìµë¶„ê¸°ì  (BEP)
```
BEP(ê°œì›”) = (ì¤‘ë„ìƒí™˜ ìˆ˜ìˆ˜ë£Œ + ì¸ì§€ì„¸) / ì›”ë³„ ì ˆê°ì•¡
```
- **ê·¼ê±°**: ëŒ€í™˜ ë¹„ìš© íšŒìˆ˜ ê¸°ê°„
- **ì˜ë¯¸**: BEP < ì”ì—¬ ê¸°ê°„ì´ë©´ ëŒ€í™˜ ì¶”ì²œ

---

## ğŸ” ì—£ì§€ ì¼€ì´ìŠ¤ ì²˜ë¦¬ (10ê°€ì§€)

### ğŸ”´ High Priority (í•„ìˆ˜ ì²˜ë¦¬ ì™„ë£Œ)
1. âœ… ì”ì—¬ ê¸°ê°„ 0 ë˜ëŠ” ìŒìˆ˜
2. âœ… ê¸ˆë¦¬ ìŒìˆ˜
3. âœ… ì”ì—¬ ê¸°ê°„ > ì „ì²´ ê¸°ê°„

### ğŸŸ¡ Medium Priority (í–¥í›„ ê°œì„ )
4. BEPê°€ ì”ì—¬ ê¸°ê°„ë³´ë‹¤ ê¸´ ê²½ìš°
5. ìˆ˜ìˆ˜ë£Œ ë©´ì œ ëŒ€ê¸° ë¡œì§ ê°œì„ 
6. í° ê¸ˆì•¡ ì˜¤ë²„í”Œë¡œìš°

### ğŸŸ¢ Low Priority (ì„ íƒ ê°œì„ )
7. ì—¬ëŸ¬ ìƒí’ˆ ì¶”ì²œ ì‹œ ê°€ì¤‘ì¹˜
8. ì˜¤ë¥˜ ë©”ì‹œì§€ ì‚¬ìš©ì ì¹œí™”ì„±
9. ì„±ëŠ¥ ìµœì í™”
10. NULL ì²˜ë¦¬

---

## ğŸŒ API ì‚¬ìš© ì˜ˆì‹œ

### ìš”ì²­
```bash
POST /api/simulate
Content-Type: application/json

{
  "currentDebt": {
    "principal": 50000000,
    "interestRate": 5.5,
    "remainingMonths": 36,
    "totalMonths": 60,
    "repaymentType": "ì›ë¦¬ê¸ˆê· ë“±",
    "earlyRepayFeeRate": 1.5,
    "feeWaiverMonths": 36
  },
  "loanProducts": [
    {
      "bankName": "KB",
      "productName": "KBì§ì¥ì¸ì‹ ìš©ëŒ€ì¶œ",
      "baseRate": 3.5,
      "additionalRate": 1.7,
      "salaryTransferDiscount": 0.3,
      "userOtherDiscount": 0.0
    }
  ],
  "hasSalaryTransfer": true,
  "mode": "best"
}
```

### ì‘ë‹µ
```json
{
  "success": true,
  "data": {
    "totalDebtBefore": 53500000,
    "totalDebtAfter": 51200000,
    "earlyRepayFee": 625000,
    "stampDuty": 70000,
    "totalRefinanceCost": 695000,
    "interestSavings": 3000000,
    "netSavings": 2305000,
    "monthlySavings": 65000,
    "breakEvenMonths": 11,
    "recommendedAction": "ì¦‰ì‹œ_ëŒ€í™˜",
    "currentRate": 5.5,
    "newRate": 4.9,
    "recommendedProduct": {
      "bankName": "KB",
      "productName": "KBì§ì¥ì¸ì‹ ìš©ëŒ€ì¶œ",
      "rate": 4.9
    }
  }
}
```

---

## ğŸ“¦ íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ finance-config.ts          # ê¸ˆìœµ ìƒìˆ˜ ê´€ë¦¬
â”‚   â”œâ”€â”€ strategies/
â”‚   â”‚   â””â”€â”€ repayment-strategy.ts      # Strategy Pattern
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ simulation-service.ts      # ì‹œë®¬ë ˆì´ì…˜ ì—”ì§„
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ validation.ts              # ì…ë ¥ê°’ ê²€ì¦
â”‚       â””â”€â”€ test-examples.ts           # í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
â””â”€â”€ app/
    â””â”€â”€ api/
        â””â”€â”€ simulate/
            â””â”€â”€ route.ts               # API ì—”ë“œí¬ì¸íŠ¸
```

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

### 5ë‹¨ê³„: Next.js í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¶•
- [ ] ì‚¬ìš©ì ëŒ€ì¶œ ì •ë³´ ì…ë ¥ í¼
- [ ] ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ ëŒ€ì‹œë³´ë“œ
- [ ] Recharts ê¸°ë°˜ ì‹œê°í™”
- [ ] Supabase ëŒ€ì¶œ ìƒí’ˆ ì¡°íšŒ
- [ ] ë°˜ì‘í˜• UI (Tailwind CSS)

### 6ë‹¨ê³„: Vercel ë°°í¬
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- [ ] ë¹Œë“œ ìµœì í™”
- [ ] Early Deploy ë° í”¼ë“œë°±
- [ ] ë„ë©”ì¸ ì—°ê²°

### 7ë‹¨ê³„: ë¬¸ì„œí™” ë° ì œì¶œ
- [ ] README ìµœì¢… ì—…ë°ì´íŠ¸
- [ ] ê¸°íšì„œ ì‘ì„±
- [ ] ê³¼ì œ ì œì¶œ

---

**ì‘ì„±ì¼**: 2026.02.11  
**Git ì»¤ë°‹**: `1813da0` - feat: 4ë‹¨ê³„ ëŒ€ì¶œ ê³„ì‚° ì•Œê³ ë¦¬ì¦˜ ì™„ì„±
